webpackJsonp([3],{"/CjD":function(t,e){},GT8n:function(t,e){},PkWx:function(t,e,a){"use strict";e.c=function(t){return Object(i.a)({url:"auth/post/list",method:"get",data:t})},e.g=function(t){return Object(i.a)({url:"auth/post/up",method:"get",data:t})},e.f=function(t){return Object(i.a)({url:"auth/post/recommend",method:"get",data:t})},e.e=function(t){return Object(i.a)({url:"auth/post/publish",method:"get",data:t})},e.d=function(t){return Object(i.a)({url:"auth/post/delete",method:"get",data:t})},e.b=function(t){return Object(i.a)({url:"auth/post/single",method:"get",data:t})},e.h=function(t){return Object(i.a)({url:"auth/post/save",method:"post",data:t})},e.a=function(){return Object(i.a)({url:"auth/category/list",method:"get"})};var i=a("vLgD")},l0YZ:function(t,e){},oOTe:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var i=a("woOf"),n=a.n(i),o=a("//Fk"),l=a.n(o),r=a("pFYg"),s=a.n(r),c=a("fZjL"),u=a.n(c),d=a("uzBN"),m={name:"editorSlideUpload",props:{color:{type:String,default:"#1890ff"}},data:function(){return{uploadPath:"/api/upload/article",dialogVisible:!1,listObj:{},fileList:[]}},methods:{checkAllSuccess:function(){var t=this;return u()(this.listObj).every(function(e){return t.listObj[e].hasSuccess})},handleSubmit:function(){var t=this,e=u()(this.listObj).map(function(e){return t.listObj[e]});this.checkAllSuccess()?(console.log(e),this.$emit("successCBK",e),this.listObj={},this.fileList=[],this.dialogVisible=!1):this.$message("请等待所有图片上传成功 或 出现了网络问题，请刷新页面重新上传！")},handleSuccess:function(t,e){for(var a=e.uid,i=u()(this.listObj),n=0,o=i.length;n<o;n++)if(this.listObj[i[n]].uid===a)return this.listObj[i[n]].picUrl=t.result.picUrl,this.listObj[i[n]].url=""+t.result.picUrl,this.listObj[i[n]].picId=t.result.picId,void(this.listObj[i[n]].hasSuccess=!0)},handleRemove:function(t){for(var e=this,a=t.uid,i=u()(this.listObj),n=function(t,n){if(e.listObj[i[t]].uid===a)return Object(d.a)({id:e.listObj[i[t]].picId}).then(function(a){delete e.listObj[i[t]]}).catch(function(){delete e.listObj[i[t]]}),{v:void 0}},o=0,l=i.length;o<l;o++){var r=n(o);if("object"===(void 0===r?"undefined":s()(r)))return r.v}},beforeUpload:function(t){var e=this,a=window.URL||window.webkitURL,i=t.uid;return this.listObj[i]={},new l.a(function(n,o){var l=new Image;l.src=a.createObjectURL(t),l.onload=function(){e.listObj[i]={hasSuccess:!1,uid:t.uid,width:this.width,height:this.height}},n(!0)})}}},p={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"upload-container"},[a("el-button",{style:{background:t.color,borderColor:t.color},attrs:{icon:"el-icon-upload",size:"mini",type:"primary"},on:{click:function(e){t.dialogVisible=!0}}},[t._v("上传图片\n  ")]),t._v(" "),a("el-dialog",{attrs:{"append-to-body":"",visible:t.dialogVisible},on:{"update:visible":function(e){t.dialogVisible=e}}},[a("el-upload",{staticClass:"editor-slide-upload",attrs:{name:"avatar",action:t.uploadPath,multiple:!0,"file-list":t.fileList,"show-file-list":!0,"list-type":"picture-card","on-remove":t.handleRemove,"on-success":t.handleSuccess,"before-upload":t.beforeUpload}},[a("el-button",{attrs:{size:"small",type:"primary"}},[t._v("点击上传")])],1),t._v(" "),a("el-button",{on:{click:function(e){t.dialogVisible=!1}}},[t._v("取 消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.handleSubmit}},[t._v("确 定")])],1)],1)},staticRenderFns:[]};var h=["advlist anchor autolink autoresize autosave code codesample colorpicker colorpicker contextmenu directionality emoticons  fullscreen hr image imagetools importcss insertdatetime legacyoutput link lists media nonbreaking noneditable pagebreak paste preview print save searchreplace spellchecker tabfocus table template textcolor textpattern visualblocks visualchars wordcount"],f=["bold italic underline strikethrough alignleft aligncenter alignright outdent indent  blockquote undo redo removeformat subscript superscript code codesample","hr bullist numlist link image charmap\t preview anchor pagebreak fullscreen insertdatetime media table emoticons forecolor backcolor"],v={name:"tinymce",components:{editorImage:a("VU/8")(m,p,!1,function(t){a("/CjD")},"data-v-22237d58",null).exports},props:{id:{type:String},value:{type:String,default:""},toolbar:{type:Array,required:!1,default:function(){return[]}},menubar:{default:"file edit insert view format table"},height:{type:Number,required:!1,default:360}},data:function(){return{hasChange:!1,hasInit:!1,tinymceId:this.id||"vue-tinymce-"+ +new Date}},watch:{value:function(t){var e=this;!this.hasChange&&this.hasInit&&this.$nextTick(function(){return window.tinymce.get(e.tinymceId).setContent(t)})}},mounted:function(){this.initTinymce()},activated:function(){this.initTinymce()},deactivated:function(){this.destroyTinymce()},methods:{initTinymce:function(){var t=this,e=this;window.tinymce.init({language:"zh_cn",selector:"#"+this.tinymceId,height:this.height,body_class:"panel-body ",object_resizing:!1,toolbar:this.toolbar.length>0?this.toolbar:f,menubar:this.menubar,plugins:h,end_container_on_empty_block:!0,powerpaste_word_import:"clean",code_dialog_height:450,code_dialog_width:1e3,advlist_bullet_styles:"square",advlist_number_styles:"default",default_link_target:"_blank",link_title:!1,init_instance_callback:function(a){e.value&&a.setContent(e.value),e.hasInit=!0,a.on("NodeChange Change KeyUp SetContent",function(){t.hasChange=!0,t.$emit("input",a.getContent({format:"raw"}))})}})},destroyTinymce:function(){window.tinymce.get(this.tinymceId)&&window.tinymce.get(this.tinymceId).destroy()},setContent:function(t){window.tinymce.get(this.tinymceId).setContent(t)},getContent:function(){window.tinymce.get(this.tinymceId).getContent({format:"text"})},imageSuccessCBK:function(t){var e=this;t.forEach(function(t){window.tinymce.get(e.tinymceId).insertContent('<img class="wscnph" src="'+t.url+'" >')})}},destroyed:function(){this.destroyTinymce()}},g={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"tinymce-container editor-container"},[e("textarea",{staticClass:"tinymce-textarea",attrs:{id:this.tinymceId}}),this._v(" "),e("div",{staticClass:"editor-custom-btn-container"},[e("editorImage",{staticClass:"editor-upload-btn",attrs:{color:"#1890ff"},on:{successCBK:this.imageSuccessCBK}})],1)])},staticRenderFns:[]};var b=a("VU/8")(v,g,!1,function(t){a("GT8n")},"data-v-270e7068",null).exports,y=a("KQHe"),_={name:"md-input",props:{icon:String,name:String,type:{type:String,default:"text"},value:[String,Number],placeholder:String,readonly:Boolean,disabled:Boolean,min:String,max:String,step:String,minlength:Number,maxlength:Number,required:{type:Boolean,default:!0},autoComplete:{type:String,default:"off"},validateEvent:{type:Boolean,default:!0}},computed:{computedClasses:function(){return{"material--active":this.focus,"material--disabled":this.disabled,"material--raised":Boolean(this.focus||this.currentValue)}}},watch:{value:function(t){this.currentValue=t}},data:function(){return{currentValue:this.value,focus:!1,fillPlaceHolder:null}},methods:{handleModelInput:function(t){var e=t.target.value;this.$emit("input",e),"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.change",[e]),this.$emit("change",e)},handleMdFocus:function(t){this.focus=!0,this.$emit("focus",t),this.placeholder&&""!==this.placeholder&&(this.fillPlaceHolder=this.placeholder)},handleMdBlur:function(t){this.focus=!1,this.$emit("blur",t),this.fillPlaceHolder=null,"ElFormItem"===this.$parent.$options.componentName&&this.validateEvent&&this.$parent.$emit("el.form.blur",[this.currentValue])}}},w={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"material-input__component",class:t.computedClasses},[a("div",{class:{iconClass:t.icon}},[t.icon?a("i",{staticClass:"el-input__icon material-input__icon",class:["el-icon-"+t.icon]}):t._e(),t._v(" "),"email"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{type:"email",name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autoComplete:t.autoComplete,required:t.required},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),t._v(" "),"url"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{type:"url",name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autoComplete:t.autoComplete,required:t.required},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),t._v(" "),"number"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{type:"number",name:t.name,placeholder:t.fillPlaceHolder,step:t.step,readonly:t.readonly,disabled:t.disabled,autoComplete:t.autoComplete,max:t.max,min:t.min,minlength:t.minlength,maxlength:t.maxlength,required:t.required},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),t._v(" "),"password"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{type:"password",name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autoComplete:t.autoComplete,max:t.max,min:t.min,required:t.required},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),t._v(" "),"tel"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{type:"tel",name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autoComplete:t.autoComplete,required:t.required},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),t._v(" "),"text"===t.type?a("input",{directives:[{name:"model",rawName:"v-model",value:t.currentValue,expression:"currentValue"}],staticClass:"material-input",attrs:{type:"text",name:t.name,placeholder:t.fillPlaceHolder,readonly:t.readonly,disabled:t.disabled,autoComplete:t.autoComplete,minlength:t.minlength,maxlength:t.maxlength,required:t.required},domProps:{value:t.currentValue},on:{focus:t.handleMdFocus,blur:t.handleMdBlur,input:[function(e){e.target.composing||(t.currentValue=e.target.value)},t.handleModelInput]}}):t._e(),t._v(" "),a("span",{staticClass:"material-input-bar"}),t._v(" "),a("label",{staticClass:"material-label"},[t._t("default")],2)])])},staticRenderFns:[]};var x=a("VU/8")(_,w,!1,function(t){a("ungE")},"data-v-bab10902",null).exports,C=a("vHhr"),F=a("PkWx"),S=(a("E4LH"),{status:"0",title:"",content:"",description:"",source:"",picurl:"",url:"",user:"",category:"",tags:"",updated_time:void 0,id:void 0}),k={name:"articleDetail",components:{Tinymce:b,MDinput:x,Upload:y.a,Sticky:C.a},data:function(){var t=this,e=function(e,a,i){""===a?(t.$message({message:e.field+"为必传项",type:"error"}),i(new Error(e.field+"为必传项"))):i()};return{postForm:n()({},S),fetchSuccess:!0,loading:!1,userLIstOptions:[],categoryList:[],contentShortLength:0,rules:{category:[{validator:e}],picurl:[{validator:e}],title:[{validator:e}]}}},created:function(){this.getCategoryList()},mounted:function(){this.id=this.$route.query.id||"",this.id?this.fetchData(this.id):this.postForm=n()({},S)},methods:{getCategoryList:function(){var t=this;Object(F.a)().then(function(e){t.categoryList=e.categoryList}).catch(function(e){t.categoryList=[]})},fetchData:function(t){var e=this;t&&Object(F.b)({id:t}).then(function(t){e.postForm=t.article,e.postForm.id=t.article._id,e.postForm.category=t.article._category,e.postForm.tags=t.article.tags.join(","),e.fetchSuccess=!0}).catch(function(t){e.fetchSuccess=!1,console.log(t)})},onSubmitForm:function(t){var e=this;this.postForm.status=t||0,this.$refs.postForm.validate(function(t){if(!t)return console.log("error submit!!"),!1;e.loading=!0,Object(F.h)(e.postForm).then(function(t){e.$notify({title:"成功",message:"发布文章成功",type:"success",duration:2e3}),e.loading=!1,e.$router.push({path:"/admin/p/index"})}).catch(function(t){e.loading=!1})})}}},j={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"createPost-container manage-article-container"},[a("el-form",{ref:"postForm",staticClass:"form-container",attrs:{"label-position":"left",model:t.postForm,rules:t.rules}},[a("sticky",{attrs:{className:"sub-navbar "+t.postForm.status}},[t.fetchSuccess?[a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],staticStyle:{"margin-left":"10px"},attrs:{type:"success"},on:{click:function(e){t.onSubmitForm(1)}}},[t._v("发布\n                ")]),t._v(" "),a("el-button",{directives:[{name:"loading",rawName:"v-loading",value:t.loading,expression:"loading"}],attrs:{type:"warning"},on:{click:function(e){t.onSubmitForm(0)}}},[t._v("草稿")])]:[a("el-tag",[t._v("发送异常错误,刷新页面,或者联系程序员")])]],2),t._v(" "),a("div",{staticClass:"createPost-main-container"},[a("el-row",[a("el-col",{attrs:{span:21}},[a("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{prop:"title"}},[a("MDinput",{attrs:{name:"title",required:"",maxlength:100},model:{value:t.postForm.title,callback:function(e){t.$set(t.postForm,"title",e)},expression:"postForm.title"}},[t._v("\n                            标题\n                        ")]),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.postForm.title.length>=26,expression:"postForm.title.length>=26"}],staticClass:"title-prompt"},[t._v("app可能会显示不全")])],1),t._v(" "),a("div",{staticClass:"postInfo-container"},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"45px",label:"类型",prop:"type"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"100px"},attrs:{placeholder:"类型"},model:{value:t.postForm.type,callback:function(e){t.$set(t.postForm,"type",e)},expression:"postForm.type"}},[a("el-option",{attrs:{label:"原创",value:"原创"}}),t._v(" "),a("el-option",{attrs:{label:"分享",value:"分享"}})],1)],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"45px",label:"分类",prop:"category"}},[a("el-select",{staticClass:"filter-item",staticStyle:{width:"160px"},attrs:{placeholder:"选择分类",name:"category"},model:{value:t.postForm.category,callback:function(e){t.$set(t.postForm,"category",e)},expression:"postForm.category"}},t._l(t.categoryList,function(t,e){return a("el-option",{key:e,attrs:{label:t.name,value:t._id}})}))],1)],1),t._v(" "),a("el-col",{attrs:{span:8}},[a("el-form-item",{staticClass:"postInfo-container-item",attrs:{"label-width":"80px",label:"发布时间:"}},[a("el-date-picker",{attrs:{type:"datetime",format:"yyyy-MM-dd HH:mm:ss",placeholder:"选择日期时间"},model:{value:t.postForm.updated_time,callback:function(e){t.$set(t.postForm,"updated_time",e)},expression:"postForm.updated_time"}})],1)],1)],1)],1)],1)],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"45px",label:"摘要:"}},[a("el-input",{staticClass:"article-textarea",attrs:{type:"textarea",rows:1,autosize:"",placeholder:"请输入内容"},model:{value:t.postForm.description,callback:function(e){t.$set(t.postForm,"description",e)},expression:"postForm.description"}}),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.contentShortLength,expression:"contentShortLength"}],staticClass:"word-counter"},[t._v(t._s(t.contentShortLength)+"字")])],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"45px",label:"标签:"}},[a("el-input",{staticClass:"article-textarea",attrs:{type:"textarea",rows:1,placeholder:"标签以,分开"},model:{value:t.postForm.tags,callback:function(e){t.$set(t.postForm,"tags",e)},expression:"postForm.tags"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"45px",label:"外链:",prop:"source"}},[a("el-input",{staticClass:"article-textarea",attrs:{type:"textarea",rows:1,placeholder:"请输入链接"},model:{value:t.postForm.source,callback:function(e){t.$set(t.postForm,"source",e)},expression:"postForm.source"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"45px",label:"配图:",prop:"picurl"}},[a("Upload",{attrs:{uploadType:"article"},model:{value:t.postForm.picurl,callback:function(e){t.$set(t.postForm,"picurl",e)},expression:"postForm.picurl"}})],1),t._v(" "),a("el-form-item",{staticStyle:{"margin-bottom":"40px"},attrs:{"label-width":"45px",label:"正文:",prop:"content"}},[a("div",{staticClass:"editor-container"},[a("tinymce",{ref:"editor",attrs:{height:500},model:{value:t.postForm.content,callback:function(e){t.$set(t.postForm,"content",e)},expression:"postForm.content"}})],1)])],1)],1)],1)},staticRenderFns:[]};var V=a("VU/8")(k,j,!1,function(t){a("l0YZ")},"data-v-61068793",null);e.default=V.exports},ungE:function(t,e){}});
//# sourceMappingURL=3.f102cd2988a9435829de.js.map